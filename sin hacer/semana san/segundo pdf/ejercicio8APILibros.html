<!-- Ejercicio 8 pg 118 2ªpdf
Crea un buscador de libros en Javascript usando la API pública openlibrary.org. Usaremos estos
endpoints:
• Búsqueda de libros: https://openlibrary.org/search.json?q=javascript
• El parámetro q (query) permite realizar la búsqueda.
• Portada: https://covers.openlibrary.org/b/isbn/$value‑S.jpg
• $value es el valor del campo ISBN presente en el json de cada objeto libro. Es posible que algu‑
nos libros no tengan este campo. Implementa la siguiente funcionalidad:
a. Crea una caja de texto y un botón “Buscar”. Cuando se pulse el botón se buscará el conte‑
nido de la caja de texto en la API de openlibrary.org usando el endpoint indicado anterior‑
mente.
b. Muestra el mensaje “No se ha encontrado ningún libro” si el número de libros encontrado
es cero.
c. En el caso de que se encuentren libros genera un bloque div con el texto “X libros encon‑
trados” sustituyendo X por el número de libros de la respuesta.
d. Finalmente genera dinámicamente un bloque div por cada libro con el título, subtítulo,
portada y año de publicación. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="divBuscar">
        <input type="text" id="inputBuscar">
        <button id="btnBuscar" >Buscar</button>
    </div>

    <div id="divResultados"></div>

    <script>
        const inputBuscar = document.getElementById("inputBuscar");
        const btnBuscar = document.getElementById("btnBuscar");
        const divResultados = document.getElementById("divResultados");

        async function buscarLibros(){
            const buscado = inputBuscar.value.trim();
            
            if (buscado === ""){
                divResultados.innerHTML = "<p>tienes que ingresar algo</p>";
                return;
            }

            const respuesta = await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(buscado)}`);
            const datos = await respuesta.json();

            let encontrados = datos.numFound;
            if (encontrados === 0) {
                divResultados.innerHTML = "<p>No se ha encontrado ningún libro</p>";
                return;
            }
            
            const cantidadLibros = document.createElement("div");
            cantidadLibros.innerHTML = `<h2>${encontrados} libros encontrados</h2>`;
            divResultados.appendChild(cantidadLibros);

            datos.docs.forEach(libro => {
                const divLibro = document.createElement('div');
                divLibro.className = 'libro';

                // Crear imagen de la portada (si tiene ISBN)
                const imgPortada = document.createElement('img');
                if (libro.isbn && libro.isbn.length > 0) {
                    imgPortada.src = `https://covers.openlibrary.org/b/isbn/${libro.isbn[0]}-S.jpg`;
                } else {
                    imgPortada.src = 'https://via.placeholder.com/50x75?text=Sin+Portada';
                }

                // Detalles del libro
                const detallesLibro = document.createElement('div');
                detallesLibro.className = 'detalles-libro';

                const titulo = document.createElement('p');
                titulo.className = 'titulo-libro';
                titulo.textContent = libro.title || 'Sin título';

                const subtitulo = document.createElement('p');
                subtitulo.className = 'subtitulo-libro';
                subtitulo.textContent = libro.subtitle || '';

                const anio = document.createElement('p');
                anio.className = 'anio-libro';
                anio.textContent = libro.first_publish_year ? `Año de publicación: ${libro.first_publish_year}` : 'Año de publicación desconocido';

                // Añadir los detalles al contenedor del libro
                detallesLibro.appendChild(titulo);
                detallesLibro.appendChild(subtitulo);
                detallesLibro.appendChild(anio);
                divLibro.appendChild(imgPortada);
                divLibro.appendChild(detallesLibro);

                // Añadir el contenedor del libro al div de resultados
                divResultados.appendChild(divLibro);
            });
            
        }
        btnBuscar.addEventListener("click", buscarLibros);
    </script>
</body>
</html>